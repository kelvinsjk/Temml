
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Temml - Convert TeX to MathML</title>

<link rel="stylesheet" href="./indexStyles.css">
<link rel="stylesheet" href="./assets/Temml-Latin-Modern.css">

<script src="./assets/temml.min.js"></script>
<script src="./assets/mhchem.min.js"></script>
<script src="./assets/physics.js"></script>
<script src="./assets/texvc.js"></script>
<script type="text/javascript" src="./xml-formatter.js"></script>
</head>

<body>
<main>
<nav>
   <ul>
     <li><a href="https://github.com/ronkok/Temml">GitHub</a></li>
     <li><a href="./docs/en/supported.html">Functions</a></li>
     <li><a href="./docs/en/administration.html">Installation</a></li>
   </ul>
</nav>

<h1 id="title">
  <math xmlns="http://www.w3.org/1998/Math/MathML" class="temml"><mrow><mstyle href="https://temml.org/" mathcolor="black"><mstyle mathsize="1.44em"><mtext>T</mtext><mspace width="-0.2em"></mspace><mpadded voffset="-0.2em" height="-0.2em" depth="+0.2em"><mtext>E</mtext></mpadded><mspace width="-0.08em"></mspace><mrow><mtext>M</mtext><mspace width="-0.08em"></mspace><mpadded voffset="0.2em" height="+0.2em" depth="-0.2em"><mtext>M</mtext></mpadded><mspace width="-0.08em"></mspace><mtext>L</mtext></mrow></mstyle></mstyle></mrow></math>
</h1>
 
<article>
  <section id="demo-parent">
    <p>A TeX-to-MathML conversion library in JavaScript.</p>

    <p></p>
    
    <div id="demo">
    <div id="input">
      <label for="demoSource">Input:</label>
      <br/>
  
      <textarea class="ioArea" id="demoSource" spellcheck="false" wrap="soft">\newcommand\d[0]{\operatorname{d}\!}

\oint_C \vec{B}\circ \d\vec{l} = \mu_0 \left( I_{\text{enc}} + \varepsilon_0 \frac{\d}{\d t} \int_S \vec{E} \circ \hat{n}\; \d a \right)</textarea>
    </div>
    <div id="spacer"></div>
    <div id="output">
      <label for="demoRendering">Output:</label>
      <br/>
  
      <div class="ioArea" id="demoRendering">
        <div id="math">
          <math display="block">
            <mrow>
              <msub>
                <mo movablelimits="false">∮</mo>
                <mi>C</mi>
              </msub>
              <mover accent="true">
                <mi>B</mi>
                <mo>⃗</mo>
              </mover>
              <mo>∘</mo>
            </mrow>
            <mrow>
              <mi mathvariant="normal">d</mi>
              <mo>⁡</mo>
              <mspace width="-0.1667em"></mspace>
              <mover accent="true">
                <mi>l</mi>
                <mo>⃗</mo>
              </mover>
              <mo stretchy="false">=</mo>
            </mrow>
            <mrow>
              <msub>
                <mi>μ</mi>
                <mn>0</mn>
              </msub>
              <mrow>
                <mo fence="true" form="prefix">(</mo>
                <msub>
                  <mi>I</mi>
                  <mtext>enc</mtext>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>ε</mi>
                  <mn>0</mn>
                </msub>
                <mfrac>
                  <mrow>
                    <mi mathvariant="normal">d</mi>
                    <mo>⁡</mo>
                    <mspace width="-0.1667em"></mspace>
                  </mrow>
                  <mrow>
                    <mi mathvariant="normal">d</mi>
                    <mo>⁡</mo>
                    <mspace width="-0.1667em"></mspace>
                    <mi>t</mi>
                  </mrow>
                </mfrac>
                <msub>
                  <mo movablelimits="false">∫</mo>
                  <mi>S</mi>
                </msub>
                <mover accent="true">
                  <mi>E</mi>
                  <mo>⃗</mo>
                </mover>
                <mo>∘</mo>
                <mover accent="true">
                  <mi>n</mi>
                  <mo>^</mo>
                </mover>
                <mspace width="0.2778em"></mspace>
                <mi mathvariant="normal">d</mi>
                <mo>⁡</mo>
                <mspace width="-0.1667em"></mspace>
                <mi>a</mi>
                <mo fence="true" form="postfix">)</mo>
              </mrow>
            </mrow>
          </math>          
        </div>
        <div id="notice"></div>
      </div>
      
    </div>
    </div>
  </section>
  <div>
    <button onclick="createPermalink()" style="width: 30px; height: 30px; margin-top: 4px; background-color: white;" title="Create permalink"><svg width="16" height="16" viewBox="0 0 16 16"><!-- Generated by IcoMoon.io -->
      <path fill="#000000" d="M6.879 9.934c-0.208 0-0.416-0.079-0.575-0.238-1.486-1.486-1.486-3.905 0-5.392l3-3c0.72-0.72 1.678-1.117 2.696-1.117s1.976 0.397 2.696 1.117c1.486 1.487 1.486 3.905 0 5.392l-1.371 1.371c-0.317 0.317-0.832 0.317-1.149 0s-0.317-0.832 0-1.149l1.371-1.371c0.853-0.853 0.853-2.241 0-3.094-0.413-0.413-0.963-0.641-1.547-0.641s-1.134 0.228-1.547 0.641l-3 3c-0.853 0.853-0.853 2.241 0 3.094 0.317 0.317 0.317 0.832 0 1.149-0.159 0.159-0.367 0.238-0.575 0.238z"></path>
      <path fill="#000000" d="M4 15.813c-1.018 0-1.976-0.397-2.696-1.117-1.486-1.486-1.486-3.905 0-5.392l1.371-1.371c0.317-0.317 0.832-0.317 1.149 0s0.317 0.832 0 1.149l-1.371 1.371c-0.853 0.853-0.853 2.241 0 3.094 0.413 0.413 0.962 0.641 1.547 0.641s1.134-0.228 1.547-0.641l3-3c0.853-0.853 0.853-2.241 0-3.094-0.317-0.317-0.317-0.832 0-1.149s0.832-0.317 1.149 0c1.486 1.486 1.486 3.905 0 5.392l-3 3c-0.72 0.72-1.678 1.117-2.696 1.117z"></path>
      </svg></button>
    <div style="float: right;">
      <input type="checkbox" id="displayMode" name="displayMode" checked>
      <label for="displayMode">Display Mode</label>&nbsp;
      <select id="MathFont" onchange="updateMathFont()">
        <option value="Latin-Modern">Latin Modern</option>
        <option value="Local">Local font</option>
        <option value="Asana">Asana</option>
        <option value="STIX2">STIX TWO</option>
        <option value="XITS">XITS</option>
      </select>&nbsp;&nbsp;
      <select id="OutputType" onchange="reprocess()">
        <option value="Math">Math</option>
        <option value="MathML">MathML</option>
      </select>&nbsp;
      <button onclick="copyMathML()" style="width: 30px; height: 30px; margin-top: 4px; background-color: white" title="Copy MathML"><svg width="16" height="16"><!-- Generated by IcoMoon.io -->
        <path fill="#000000" d="M10 4v-4h-7l-3 3v9h6v4h10v-12h-6zM3 1.414v1.586h-1.586l1.586-1.586zM1 11v-7h3v-3h5v3l-3 3v4h-5zM9 5.414v1.586h-1.586l1.586-1.586zM15 15h-8v-7h3v-3h5v10z"></path>
        </svg>
      </button>
  </div>
</div>

<div id="why">
  <ul>
    <li>Fast</li>
    <li>Lightweight</li>
    <li>Extensive LaTeX <a href="./docs/en/supported.html">coverage</a></li>
    <li>Thoroughly <span class="dropdown">
      <button class="dropbtn">tested</button>
      <span class="dropdown-content">
        <a href="./tests/mozilla-tests.html">Mozilla tests</a>
        <a href="./tests/wiki-tests.html">Wikipedia tests</a>
        <a href="./tests/mhchem-tests.html">mhchem tests</a>
      </span>
    </span></li>
    <li>Works in browser or server-side with Node.js</li>
    <li>No dependencies</li>
    <li>Use any math font</li>
    <li>MathML is supported by Firefox and partly supported by Safari.<br>
      It will <a href="https://www.igalia.com/2021/08/09/MathML-Progress.html">soon</a> be supported by Chrome, Edge, Opera, and Brave.</li>
  </ul>
</div>
<br>

</article>

<div id="copyright">Copyright © 2021, 2022 Ron Kok. Released under the <a href="https://opensource.org/licenses/MIT">MIT License</a></div>

<script>
  // Find out if the browser supports MathML.
  let hasMathML = false;
  if (document.createElement) {
    var div = document.createElement("div");
    div.style.position = "absolute"; div.style.top = div.style.left = 0;
    div.style.visibility = "hidden"; div.style.width = div.style.height = "auto";
    div.style.fontFamily = "serif"; div.style.lineheight = "normal";
    div.innerHTML = "<math><mfrac><mi>xx</mi><mi>yy</mi></mfrac></math>";
    document.body.appendChild(div);
    hasMathML = (div.offsetHeight > div.offsetWidth);
  }
  if (!hasMathML) {
    // As a backupt, insert the mathml.css style sheet.
    const notice = document.getElementById("notice");
    notice.textContent = "This browser does not support MathML. Try Firefox or Safari."
    link = document.createElement("link");
    link.href = "./mathml.css";
    link.rel = "stylesheet";
    document.head.appendChild(link);
  }

  const input = document.getElementById("demoSource");
  const math = document.getElementById("math");
  const mode = document.querySelector('input[id="displayMode"]');

  const hash = location.hash
  if (hash && hash.length > 1) {
    getHash()
  } else {
    if (input.value !== `\\newcommand\\d[0]{\\operatorname{d}\\!}

\\oint_C \\vec{B}\\circ \\d\\vec{l} = \\mu_0 \\left( I_{\\text{enc}} + \\varepsilon_0 \\frac{\\d}{\\d t} \\int_S \\vec{E} \\circ \\hat{n}\\; \\d a \\right)`) {
    }
    reprocess()
  }


  input.addEventListener("input", reprocess, false);
  mode.addEventListener('change', () => { reprocess() });
  window.addEventListener('hashchange', () => { getHash() }, false)

  function reprocess() {
    if (document.getElementById("OutputType").value === "Math") {
      temml.render(input.value, math, {displayMode: mode.checked});
      temml.postProcess(math)
    } else {
      math.innerHTML = ""
      const format = require('xml-formatter');
      math.appendChild(document.createElement("pre"))
      math.firstChild.innerText = format(
        temml.renderToString(input.value, {displayMode: mode.checked}),
        { indentation: '  ', collapseContent: true, lineSeparator: '\n' });
    }
  }

  function updateMathFont() {
    // Change the CSS style sheet.
    const temmlRegEx = /assets\/Temml-.+\.css$/
    const links = [...document.head.getElementsByTagName('link')];
    links.forEach(link => {
      if (temmlRegEx.test(link.href)) {
        link.setAttribute("href", `./assets/Temml-${document.getElementById("MathFont").value}.css`);
      }
    })
  }

  function copyMathML() {
    const format = require('xml-formatter');
    var copyText = format(
      temml.renderToString(input.value, {displayMode: mode.checked}),
      { indentation: '  ', collapseContent: true, lineSeparator: '\n' }
    )
    navigator.clipboard.writeText(copyText)
  }

  const symbols = /[\r\n%#()<>?[\\\]^`{|}]/g
  function createPermalink() {
    const mathML = input.value
    if (mathML && mathML.length > 0) {
      location.hash = "#" + mathML.replace(symbols, encodeURIComponent)
    }
  }

  function getHash()  {
    const hash = location.hash
    if (hash.length > 1) {
      const tex = decodeURIComponent(hash.slice(1))
      input.textContent = tex
      reprocess()
    }
  }
</script>

</body>
</html>
